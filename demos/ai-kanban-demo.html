<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Kanban</title>
  <script type="module" src="../lib/ask-ai/ask-llm.js"></script>
  <script type="module" src="../lib/app-layout/app-layout.js"></script>
  <script type="module" src="../lib/app-router/app-router.js"></script>
  <script type="module" src="../lib/http-request/http-request.js"></script>
  <script type="module" src="../lib/app-modal/app-modal.js"></script>
  <script type="module" src="../lib/kanban-board/kanban-board.js"></script>
  <script type="module" src="../lib/note-card/note-card.js"></script>

  <script type="module" src="../lib/ace-editor/ace-editor.js"></script>
  <!-- <script type="module" src="../lib/"></script> -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.bubble.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet" />

  <link rel="stylesheet" href="../lib/themes/light-theme.css">
  <!-- Centered viewport -->
</head>

<body>

  <!-- <button id="ask-ai-open-btn">open assistant</button> -->

  <http-request id="post-to-llm" method="post" trigger="ask-llm" on="prompt"
    url="https://cjyb64boo0.execute-api.us-east-2.amazonaws.com/dev/ask-llm" target="ask-llm" append>
    <template>
      <p name="response"></p>
    </template>
  </http-request>
  <script>
    document.querySelector('#post-to-llm')?.addEventListener('response', event => {
      console.log('request response', event.detail)
      const askLLM = document.querySelector('ask-llm')
      const response = document.createElement('section')
      response.setAttribute('role', 'assistant')
      // response.setAttribute('data-sender', 'llm')
      response.setAttribute('contenteditable', '')
      response.innerHTML = `<p>${event.detail.response}</p>`
      askLLM.append(response)
    })
  </script>
  <main>

    <ask-llm trigger="#send-btn" on="prompt" contenteditable>

      <section role="system">

        <p>You are running on a web browser, if you have plain html as reponse it will be rendered. When ansering with
          html, don't scape it and add it without the code and pre tags.</p>

        <p>if you are intentionally asked to show sample html code, escape it and use the corresponding
        <pre><code></code></pre> tags to display it.</p>

        <source src="../lib/http-request/readme.md" type="text/plain">
        <source src="../lib/kanban-board/readme.md" type="text/plain">
        <source src="../lib/app-modal/readme.md" type="text/plain">
        <source src="../lib/app-layout/readme.md" type="text/plain">
        <source src="../lib/app-router/readme.md" type="text/plain">

        <p>Remember that this is a web environment, DO NOT answer using MARKDOWN syntax, it won't work, please format everything in html  using code and pre tags</p>

        <p>If you are asked to render HTML just return you response as plain HTML text, don't use pre and code tags or markdown code syntax.</p>



      </section>

      <!-- <img src="./assets/small-cat.png" alt=""> -->
      <!-- <p>What can you see in this image</p> -->
      <!-- <section role="user">
        <p>hi, are you there?</p>
      </section> -->

      
    </ask-llm>

  </main>
  <!-- <textarea name="prompt" id="prompt" rows="20" cols="50">can you summarize this?</textarea> -->

  <hr>

  <section>
    <textarea name="" id="user-prompt"></textarea>
    <button id="send-btn">send</button>
    <script>
      document.querySelector('#send-btn')
        .addEventListener('click', event => {
          const prompt = document.querySelector('#user-prompt').value
          const promptHtml = document.querySelector('#prompt-editor')?.querySelector('.ql-container')
          // alert(prompt)
          console.log('promptHtml.innerHTML', promptHtml.innerHTML)
          const promptEvent = new CustomEvent('prompt', {composed: true, bubbles: true, detail: {
            prompt: promptHtml,
          }})
          event.target.dispatchEvent(promptEvent)
          document.querySelector('#user-prompt').value = ''
          // promptHtml.innerHTML = ''
          console.log('promptHtml', promptHtml)
        })
    </script>

    <note-card id="prompt-editor" editable controls>
      <section>
        <h1>sample text</h1>
      </section>
    </note-card>
    <!-- <ace-editor></ace-editor> -->
  </section>


  <!-- <app-modal trigger="#ask-ai-open-btn">
    <h3 slot="title">Assistant</h3>
    <section>
      <textarea name="" id=""></textarea>
      <button>ask</button>
    </section>
  </app-modal> -->


  <!-- <kanban-board id="cake-recipe" title="Chocolate Cake Recipe">

    <kanban-column id="todo" title="To Do">
    
     <simple-card>1. Preheat oven to 350Â°F. Grease a 9x13 inch baking pan and set aside.</simple-card>
     
     <simple-card>2. In a large bowl, whisk together the flour, sugar, cocoa powder, baking soda and salt.</simple-card>
     
     <simple-card>3. In a separate bowl, whisk the eggs until light and fluffy. Whisk in the milk, oil and vanilla.</simple-card>
     
     <simple-card>4. Pour the wet ingredients into the dry ingredients and mix just until combined.</simple-card>
     
     <simple-card>5. Slowly pour the boiling water into the batter and mix until smooth.</simple-card>
     
     <simple-card>6. Pour the batter into the prepared pan. Bake for 30-35 minutes, until a toothpick inserted in the center comes out clean.</simple-card>
     
     <simple-card>7. Allow the cake to cool completely before frosting. You can frost it with your choice of frosting such as chocolate buttercream or cream cheese frosting.</simple-card>
     
     <simple-card>8. Cut into squares and enjoy! Store any leftovers in an airtight container at room temperature for up to 3 days.</simple-card>
  
    </kanban-column>
  
    <kanban-column id="doing" title="In Progress">
  
    </kanban-column>
  
    <kanban-column id="done" title="Done">
  
    </kanban-column>
  
  </kanban-board> -->


</body>

</html>