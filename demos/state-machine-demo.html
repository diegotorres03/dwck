<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>State Machine Demo</title>
  <script type="module" src="../lib/state-machine/state-machine.js"></script>
  <script type="module" src="../lib/app-modal/app-modal.js"></script>
  <link rel="stylesheet" href="../lib/themes/dark-theme.css">
</head>

<body>


  <button id="start-btn">start</button>
  <button id="green-btn">green</button>
  <!-- <button id="red-btn">red</button> -->


  <state-machine trigger="#start-btn" on="click" id="test-machine" initial="start" final="done" data-counter="10"
    trigger="#start-machine" on="click">

    <machine-state id="start">
      <state-transition target="green" wait="1s"></state-transition>
    </machine-state>


    <machine-state id="green">

      <state-transition target="red" wait="1s"></state-transition>
    </machine-state>


    <machine-state id="red" wait="2s">

      <state-transition trigger="#re-start-modal" on="accepted" target="green" filter="isOdd"></state-transition>
      <state-transition trigger="#re-start-modal" on="accepted" target="done" not filter="isOdd"></state-transition>
      <!-- <state-transition trigger="#re-start-modal" on="accepted" target="green"></state-transition> -->
      <state-transition trigger="#re-start-modal" on="declined" target="done"></state-transition>

      <app-modal id="re-start-modal">
        <h2 slot="title">red</h2>
        <div>some value <input type="number" name="value"></div>
      </app-modal>
    </machine-state>

    <machine-state id="done" final>
    </machine-state>

  </state-machine>

  <script>
    function isOdd({ value }) {
      const odd = Number(value) % 2 === 1
      console.log('isOdd',odd)
      return odd
    }
  </script>


  <app-modal trigger="state-machine" on="done">
    <h2 slot="title">red</h2>
    <p>Thanks for using this machine</p>
  </app-modal>


  
    <state-machine id="my-machine" data-counter="0" initial="#start">

        <machine-state id="start">
            <button>asdasd</button>
            <state-transition target="#next">
            </state-transition>
            <state-transition trigger="#done-btn" on="click" target="#done"></state-transition>
        </machine-state>
    
        <machine-state id="next" data-variable="this will be passed every time when entering this state"></machine-state>
    
        <machine-state id="done" type="final" ></machine-state>
        
    </state-machine>




</body>

</html>